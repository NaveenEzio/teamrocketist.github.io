<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  <title>Ofensive 100 - CTF Trend Micro Online Qualifier 2016 | TeamRocketIST - Portuguese CTF Team</title>
  <meta name="description" content="Find the flag.https://www.mediafire.com/?3x3m94598518054openssl enc -d -aes-256-cbc -k x0nSTZ9NrDgvCnqKhL9y -in files1.enc -out files1.zipunzip files1.zip  After unzipping the file I found strange it">
<meta name="keywords" content="web,hash,bruteforce,md5">
<meta property="og:type" content="article">
<meta property="og:title" content="Ofensive 100 - CTF Trend Micro Online Qualifier 2016">
<meta property="og:url" content="https://teamrocketist.github.io/2016/07/31/Ofensive-100-CTF-Trend-Micro-Online-Qualifier-2016/index.html">
<meta property="og:site_name" content="TEAMROCKETIST">
<meta property="og:description" content="Find the flag.https://www.mediafire.com/?3x3m94598518054openssl enc -d -aes-256-cbc -k x0nSTZ9NrDgvCnqKhL9y -in files1.enc -out files1.zipunzip files1.zip  After unzipping the file I found strange it">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-08-10T02:50:42.021Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ofensive 100 - CTF Trend Micro Online Qualifier 2016">
<meta name="twitter:description" content="Find the flag.https://www.mediafire.com/?3x3m94598518054openssl enc -d -aes-256-cbc -k x0nSTZ9NrDgvCnqKhL9y -in files1.enc -out files1.zipunzip files1.zip  After unzipping the file I found strange it">
  
    <link rel="alternate" href="/atom.xml" title="TEAMROCKETIST" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/avatar.png" type="image/x-icon">
  
  <!-- font-awesome CSS -->
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/style.css">
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104385070-1', 'auto');
  ga('send', 'pageview');

</script>


</head>


<body class="main-center">
  <section class="mainside">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/teamrocketist" target="_blank">
          <img class="thumb-xl img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">TeamRocketIST</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF Team</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="fa fa-map-marker"></i> Lisbon, Portugal</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat"><i class="fa fa-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
            <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            <!-- <span class="ins-close ins-selectable"><i class="fa fa-times"></i></span> -->
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>

</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav main-nav">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="fa fa-fw fa-home"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="fa fa-fw fa-archive"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="fa fa-fw fa-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="fa fa-fw fa-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="fa fa-fw fa-code"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="fa fa-fw fa-gg"></i>
            
            <span class="menu-title">Links</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="fa fa-fw fa-coffee"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      <div class="footer">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/teamrocketist" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="fa fa-github"></i></a></li>
        
        <li><a href="https://twitter.com/teamrocketist" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="fa fa-twitter"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="fa fa-rss"></i></a></li>
        
    </ul>
    
    <div class="copyright">
        &copy; 2017 TEAMROCKETIST
        <div class="publishby">
        	<!-- Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. -->
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</div>
    </nav>
  </div>
</section>

  
    <section class="sidebar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            
            <div class="content">
                <p>PC MASTER RACE!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Crypto/">Crypto</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Forensics/">Forensics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reverse/">Reverse</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">7</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/LTE/">LTE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/">RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/X-Forwarded-For/">X-Forwarded-For</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/base64/">base64</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bruteforce/">bruteforce</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crypto/">crypto</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/filterbypass/">filterbypass</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/forensics/">forensics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdb/">gdb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hash/">hash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/login/">login</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/md5/">md5</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/noSql/">noSql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pcap/">pcap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/perl/">perl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/png/">png</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/regex/">regex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverse/">reverse</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shellshock/">shellshock</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqli/">sqli</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/usb/">usb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wireshark/">wireshark</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xor/">xor</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/LTE/" style="font-size: 13px;">LTE</a> <a href="/tags/Misc/" style="font-size: 13px;">Misc</a> <a href="/tags/RSA/" style="font-size: 13px;">RSA</a> <a href="/tags/X-Forwarded-For/" style="font-size: 13px;">X-Forwarded-For</a> <a href="/tags/base64/" style="font-size: 13px;">base64</a> <a href="/tags/bruteforce/" style="font-size: 13.33px;">bruteforce</a> <a href="/tags/crypto/" style="font-size: 13.67px;">crypto</a> <a href="/tags/filterbypass/" style="font-size: 13px;">filterbypass</a> <a href="/tags/forensics/" style="font-size: 13px;">forensics</a> <a href="/tags/gdb/" style="font-size: 13px;">gdb</a> <a href="/tags/hash/" style="font-size: 13px;">hash</a> <a href="/tags/java/" style="font-size: 13px;">java</a> <a href="/tags/login/" style="font-size: 13px;">login</a> <a href="/tags/md5/" style="font-size: 13.33px;">md5</a> <a href="/tags/mongodb/" style="font-size: 13px;">mongodb</a> <a href="/tags/network/" style="font-size: 13px;">network</a> <a href="/tags/noSql/" style="font-size: 13px;">noSql</a> <a href="/tags/pcap/" style="font-size: 13px;">pcap</a> <a href="/tags/perl/" style="font-size: 13px;">perl</a> <a href="/tags/png/" style="font-size: 13px;">png</a> <a href="/tags/python/" style="font-size: 13px;">python</a> <a href="/tags/regex/" style="font-size: 13px;">regex</a> <a href="/tags/reverse/" style="font-size: 13.67px;">reverse</a> <a href="/tags/shellshock/" style="font-size: 13px;">shellshock</a> <a href="/tags/sql/" style="font-size: 13px;">sql</a> <a href="/tags/sqli/" style="font-size: 13px;">sqli</a> <a href="/tags/usb/" style="font-size: 13px;">usb</a> <a href="/tags/web/" style="font-size: 14px;">web</a> <a href="/tags/wireshark/" style="font-size: 13px;">wireshark</a> <a href="/tags/xor/" style="font-size: 13px;">xor</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Network/">Network</a>
              </p>
              <p class="item-title">
                <a href="/2017/08/07/Network-Sha2017-Abuse-Mail-300/" class="title">[Network] Sha2017 - Abuse Mail [300]</a>
              </p>
              <p class="item-date">
                <time datetime="2017-08-07T12:52:21.000Z" itemprop="datePublished">2017-08-07</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Web/">Web</a>
              </p>
              <p class="item-title">
                <a href="/2017/08/02/Web-Bugs-Bunny-CTF-LQI-X-140/" class="title">[Web] Bugs Bunny CTF - LQI_X 140</a>
              </p>
              <p class="item-date">
                <time datetime="2017-08-02T10:29:58.000Z" itemprop="datePublished">2017-08-02</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Reverse/">Reverse</a>
              </p>
              <p class="item-title">
                <a href="/2017/08/01/Reverse-BugsBunny-CTF-Rev75/" class="title">[Reverse] BugsBunny CTF - Rev75</a>
              </p>
              <p class="item-date">
                <time datetime="2017-08-01T08:03:50.000Z" itemprop="datePublished">2017-08-01</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Reverse/">Reverse</a>
              </p>
              <p class="item-title">
                <a href="/2017/07/31/Reverse-Bugs-Bunny-CTF-Rev100/" class="title">[Reverse] Bugs Bunny CTF - Rev100</a>
              </p>
              <p class="item-date">
                <time datetime="2017-07-31T15:14:17.000Z" itemprop="datePublished">2017-07-31</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Reverse/">Reverse</a>
              </p>
              <p class="item-title">
                <a href="/2017/07/31/Reverse-Bugs-Bunny-CTF-Rev-50/" class="title">[Reverse] - Bugs Bunny CTF - Rev 50</a>
              </p>
              <p class="item-date">
                <time datetime="2017-07-31T14:16:03.000Z" itemprop="datePublished">2017-07-31</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</section>

  
  <section class="main">
  <div class="content">
  <article id="post-Ofensive-100-CTF-Trend-Micro-Online-Qualifier-2016" class="article article-type-post" itemscope itemprop="blogPost">
    
    <header class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Ofensive 100 - CTF Trend Micro Online Qualifier 2016
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="fa fa-calendar-check-o"></i>
	<a href="/2016/07/31/Ofensive-100-CTF-Trend-Micro-Online-Qualifier-2016/" class="article-date">
	  <time datetime="2016-07-31T10:22:58.000Z" itemprop="datePublished">2016-07-31</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </span>

        
  <span class="article-tag">
    <i class="fa fa-tag"></i>
	<a class="article-tag-link" href="/tags/bruteforce/">bruteforce</a>, <a class="article-tag-link" href="/tags/hash/">hash</a>, <a class="article-tag-link" href="/tags/md5/">md5</a>, <a class="article-tag-link" href="/tags/web/">web</a>
  </span>


        

		
		
	
		<span class="post-wordcount hidden-xs">Word Count: 816 (words)</span>
	
	
		<span class="post-readcount hidden-xs">Read Time: 5 (min)</span>
	

      </div>
    </header>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>Find the flag.<br><a href="https://www.mediafire.com/?3x3m94598518054" rel="external" target="_blank">https://www.mediafire.com/?3x3m94598518054</a><br><br>openssl enc -d -aes-256-cbc -k x0nSTZ9NrDgvCnqKhL9y -in files1.enc -out files1.zip<br>unzip files1.zip</blockquote>

<p>After unzipping the file I found strange it was a hta file extension which I never heard off, but after analyzing the code it was just some html and javascript.</p>
<p>Some of the JavaScript code was minimized so I just used <a href="http://jsbeautifier.org/" target="_blank" rel="external">http://jsbeautifier.org/</a> to make it readable for humans.</p>
<p>The first thing you can see in the code are these three interesting hashes:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">window</span>.host=FnBJT9OVUieRCjeTgMPMBe4U.hs;</div><div class="line"><span class="keyword">var</span> m = <span class="built_in">window</span>.host;</div><div class="line"><span class="keyword">var</span> nl = [<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">0</span>];</div><div class="line"><span class="keyword">var</span> ko=<span class="string">"c33367701511b4f6020ec61ded352059"</span>;</div><div class="line"><span class="keyword">var</span> ka=<span class="string">"61636f697b57b5b7d389db0edb801fc3"</span>;</div><div class="line"><span class="keyword">var</span> kq=<span class="string">"d2172edf24129e06f3913376a12919a4"</span>;</div></pre></td></tr></table></figure>
<p>The first one is actually very easy to crack I used john the ripper but you could find it even easier by searching it on google you can immediately find it’s a md5 hash by  analysing the FnBJT9OVUieRCjeTgMPMBe4U.hs which is a known js code for md5 encryption.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">kinyabitch@Debian ~<span class="regexp">/h/</span>p/j/run&gt; ./john --wordlist=password.lst  pass.txt  --format=raw-md5</div><div class="line">Loaded <span class="number">1</span> password hash (Raw MD5 [<span class="number">128</span>/<span class="number">128</span> SSE2 intrinsics <span class="number">12</span>x])</div><div class="line"><span class="number">654321</span>           (?)</div><div class="line">guesses: <span class="number">1</span>  time: <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> DONE (Sun Jul <span class="number">31</span> <span class="number">13</span>:<span class="number">09</span>:<span class="number">53</span> <span class="number">2016</span>)  c/s: <span class="number">960</span>  trying: <span class="number">1</span>q2w3e - blazer</div><div class="line">Use the <span class="string">"--show"</span> option to display all <span class="keyword">of</span> the cracked passwords reliably</div></pre></td></tr></table></figure>
<p>After cracking it with john you find the hash c33367701511b4f6020ec61ded352059 was actually ‘654321’.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkPW</span>(<span class="params">pass</span>) </span>&#123;</div><div class="line"><span class="keyword">if</span> (pass != <span class="literal">null</span> &amp;&amp; pass == <span class="string">"close"</span>) &#123;</div><div class="line"><span class="built_in">window</span>.close();</div><div class="line">&#125;;</div><div class="line"><span class="keyword">if</span> (pass == <span class="literal">null</span> || pass.length != <span class="number">24</span>) &#123;</div><div class="line">alert(<span class="string">"Wrong password"</span>);</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">if</span> (pass.substring(<span class="number">0</span>, <span class="number">6</span>) != <span class="string">"TMCTF&#123;"</span> || pass.substr(pass.length - <span class="number">1</span>) != <span class="string">"&#125;"</span>) &#123;</div><div class="line">alert(<span class="string">"Wrong password"</span>);</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> pwbody = (<span class="string">" "</span> + pass.substring(<span class="number">6</span>, pass.length - <span class="number">1</span>)).split(<span class="string">""</span>);</div><div class="line"><span class="keyword">var</span> h1 = <span class="string">""</span>,</div><div class="line">h2 = <span class="string">""</span>,</div><div class="line">h3 = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pwbody.length;) &#123;</div><div class="line">h1 += pwbody[nl[++i]];</div><div class="line">h2 += pwbody[nl[++i]];</div><div class="line">h3 += pwbody[nl[++i]];</div><div class="line">&#125;;</div><div class="line"><span class="keyword">if</span> (co(m(h1.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>))) &amp;&amp; ca(m(h3.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>))) &amp;&amp; cq(m(h2.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>)))) &#123;</div><div class="line">alert(<span class="string">"ok!"</span>);</div><div class="line"><span class="built_in">window</span>.close();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">alert(<span class="string">"Wrong password"</span>);</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">co</span>(<span class="params">o</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (o === ko);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ca</span>(<span class="params">a</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (a === ka.replace(<span class="regexp">/6/g</span>, <span class="string">'2'</span>).replace(<span class="regexp">/b/g</span>, <span class="string">'a'</span>).replace(<span class="regexp">/d/g</span>, <span class="string">'4'</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cq</span>(<span class="params">q</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (q === kq.replace(<span class="regexp">/1/g</span>, <span class="string">'5'</span>).replace(<span class="regexp">/2/g</span>, <span class="string">'8'</span>).replace(<span class="regexp">/3/g</span>, <span class="string">'b'</span>).replace(<span class="regexp">/9/g</span>, <span class="string">'c'</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Analyzing this function was the key to this challenge with this code you can find out the flag has 18 characters always having this format “TMCTF{pass}” otherwise will be always wrong.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">if</span> (pass.substring(<span class="number">0</span>, <span class="number">6</span>) != <span class="string">"TMCTF&#123;"</span> || pass.substr(pass.length - <span class="number">1</span>) != <span class="string">"&#125;"</span>) &#123;</div><div class="line">alert(<span class="string">"Wrong password"</span>);</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> pwbody = (<span class="string">" "</span> + pass.substring(<span class="number">6</span>, pass.length - <span class="number">1</span>)).split(<span class="string">""</span>);</div></pre></td></tr></table></figure>
<p>After passing this first length checks you will notice that this for loop is actually mixing from different indexes splited into 3 strings (h1, h2, h3).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pwbody.length;) &#123;</div><div class="line">h1 += pwbody[nl[++i]];</div><div class="line">h2 += pwbody[nl[++i]];</div><div class="line">h3 += pwbody[nl[++i]];</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Then you will see somethig that is a little confusing  3 boolean conditions (co, ca and cq),the first regex expression replaces characters like spaces you will find the function in “m” that is actually the hash function into md5:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">if</span> (co(m(h1.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>))) &amp;&amp; ca(m(h3.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>))) &amp;&amp; cq(m(h2.replace(<span class="regexp">/(^\s+)|(\s+$)/g</span>, <span class="string">""</span>)))) &#123;...&#125;</div></pre></td></tr></table></figure>
<p>And now after looking to this 3 functions you will realize why you couldn’t crack the other two, because some of its characters are being replaced by the right ones making the hash much easier to crack (you can copy the entire js code (browser JS console) and just run the replace code in ka and kq string).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">co</span>(<span class="params">o</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (o === ko);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ca</span>(<span class="params">a</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (a === ka.replace(<span class="regexp">/6/g</span>, <span class="string">'2'</span>).replace(<span class="regexp">/b/g</span>, <span class="string">'a'</span>).replace(<span class="regexp">/d/g</span>, <span class="string">'4'</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cq</span>(<span class="params">q</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> (q === kq.replace(<span class="regexp">/1/g</span>, <span class="string">'5'</span>).replace(<span class="regexp">/2/g</span>, <span class="string">'8'</span>).replace(<span class="regexp">/3/g</span>, <span class="string">'b'</span>).replace(<span class="regexp">/9/g</span>, <span class="string">'c'</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&gt; <span class="string">"61636f697b57b5b7d389db0edb801fc3"</span>.replace(<span class="regexp">/6/g</span>, <span class="string">'2'</span>).replace(<span class="regexp">/b/g</span>, <span class="string">'a'</span>).replace(<span class="regexp">/d/g</span>, <span class="string">'4'</span>);</div><div class="line"></div><div class="line"><span class="number">21232</span>f297a57a5a743894a0e4a801fc3</div><div class="line"></div><div class="line">&gt; <span class="string">"d2172edf24129e06f3913376a12919a4"</span>.replace(<span class="regexp">/1/g</span>, <span class="string">'5'</span>).replace(<span class="regexp">/2/g</span>, <span class="string">'8'</span>).replace(<span class="regexp">/3/g</span>, <span class="string">'b'</span>).replace(<span class="regexp">/9/g</span>, <span class="string">'c'</span>);</div><div class="line"></div><div class="line">d8578edf8458ce06fbc5bb76a58c5ca4</div></pre></td></tr></table></figure>
<p>A now cracking it on john you find out they ‘qwerty’ and ‘admin’.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">kinyabitch@Debian ~<span class="regexp">/h/</span>p/j/run&gt; ./john --wordlist=password.lst  pass2.txt  --format=raw-md5</div><div class="line">Loaded <span class="number">3</span> password hashes <span class="keyword">with</span> no different salts (Raw MD5 [<span class="number">128</span>/<span class="number">128</span> SSE2 intrinsics <span class="number">12</span>x])</div><div class="line">Remaining <span class="number">2</span> password hashes <span class="keyword">with</span> no different salts</div><div class="line">qwerty           (?)</div><div class="line">admin            (?)</div></pre></td></tr></table></figure>
<p>After finding this 3 hashes you can finally realize you can reconstruct the password basing on that for loop, I wrote a python script to make it easier to change (doing manually would take a lot of time and I could make mistakes):</p>
<p><a href="http://pastebin.com/embed_iframe/phYNZi4A" target="_blank" rel="external">http://pastebin.com/embed_iframe/phYNZi4A</a><br>After running it you will find the flag:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">kinyabitch@Debian ~<span class="regexp">/h/</span>c/ofensive&gt; python crack.py</div><div class="line">TMCTF&#123;q6r4dy5ei2na1twm3&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <blockquote>
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link">
      <strong>Link to this article：</strong>
      <a href="https://teamrocketist.github.io/2016/07/31/Ofensive-100-CTF-Trend-Micro-Online-Qualifier-2016/" title="Ofensive 100 - CTF Trend Micro Online Qualifier 2016" target="_blank" rel="external">https://teamrocketist.github.io/2016/07/31/Ofensive-100-CTF-Trend-Micro-Online-Qualifier-2016/</a>
    </li>
    
    <!--li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li-->
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/teamrocketist" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/teamrocketist" target="_blank"><span class="text-dark">TeamRocketIST</span><small class="ml-1x">CTF Team</small></a></h3>
        <div>Portuguese Computer Science Students</div>
      </div>
    </figure>
  </div>
</div>


    </footer>
  </article>
  
    
  <div id="comments"></div>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2016/08/07/Trend-Micro-Online-Qualifier-Misc-200/" title="Trend Micro Online Qualifier - Misc 200"><i class="fa fa-angle-left" aria-hidden="true"></i>&nbsp;&nbsp;Newer</a>
    </li>
    
    
  </ul>
  
  
  
  <div class="bar-right">
    <div class="share-component" data-sites="facebook,twitter" data-mobile-sites="facebook,twitter"></div>
  </div>
  
</nav>

</section>

  <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.js"></script>
<script src="/js/application.js"></script>



  <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>




<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-104385070-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</body>
</html>